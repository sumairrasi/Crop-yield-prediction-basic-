from flask import Flask, render_template, request
import pickle
from sklearn.preprocessing import StandardScaler
app = Flask(__name__)
model = pickle.load(open('model_yield.pkl', 'rb'))
@app.route('/',methods=['GET'])
def Home():
    return render_template('Home.html')
standard_to = StandardScaler()
@app.route("/predict", methods=['POST'])
def predict():
    if request.method == 'POST':
        Area=request.form['myAreas']
        if(Area=='Albania'):
            Area=0
            temp1=10
            temp2=23
        elif(Area=='Algeria'):
            Area=1
            temp1=11
            temp2=24
        elif(Area=='Angola'):
            Area=2
            temp1=18
            temp2=29
        elif(Area=='Argentina'):
            Area=3
            temp1=11
            temp2=24
        elif(Area=='Armenia'):
            Area=4
            temp1=2.5
            temp2=16
        elif(Area=='Australia'):
            Area=5
            temp1=6
            temp2=25
        elif(Area=='Austria'):
            Area=6
            temp1=2
            temp2=15
        elif(Area=='Azerbaijan'):
            Area=7
            temp1=5
            temp2=19
        elif(Area=='Bahamas'):
            Area=8
            temp1=19
            temp2=30
        elif(Area=='Bahrain'):
            Area=9
            temp1=20
            temp2=33
        elif(Area=='Bangladesh'):
            Area=10
            temp1=20
            temp2=31
        elif(Area=='Belarus'):
            Area=11
            temp1=1.5
            temp2=12
        elif(Area=='Belgium'):
            Area=12
            temp1=4
            temp2=16
        elif(Area=='Botswana'):
            Area=13
            temp1=13
            temp2=25
        elif(Area=='Brazil'):
            Area=14
            temp1=12
            temp2=33
        elif(Area=='Bulgaria'):
            Area=15
            temp1=3
            temp2=16
        elif(Area=='Burkina Faso'):
            Area=16
            temp1=23
            temp2=34
        elif(Area=='Burundi'):
            Area=17
            temp1=15
            temp2=27
        elif(Area=='Cameroon'):
            Area=18
            temp1=19
            temp2=30
        elif(Area=='Canada'):
            Area=19
            temp1=-1
            temp2=15
        elif(Area=='Central African Republic'):
            Area=20
            temp1=19
            temp2=31
        elif(Area=='Chile'):
            Area=21
            temp1=-1
            temp2=18
        elif(Area=='Colombia'):
            Area=22
            temp1=16
            temp2=32
        elif(Area=='Croatia'):
            Area=23
            temp1=4
            temp2=16
        elif(Area=='Denmark'):
            Area=24
            temp1=2
            temp2=14
        elif(Area=='Dominican Republic'):
            Area=25
            temp1=21
            temp2=33
        elif(Area=='Ecuador'):
            Area=26
            temp1=12
            temp2=28
        elif(Area=='Egypt'):
            Area=27
            temp1=15
            temp2=28
        elif(Area=='El Salvador'):
            Area=28
            temp1=21
            temp2=31
        elif(Area=='Eritrea'):
            Area=29
            temp1=19
            temp2=30
        elif(Area=='Estonia'):
            Area=30
            temp1=1
            temp2=12
        elif(Area=='Finland'):
            Area=31
            temp1=1
            temp2=11
        elif(Area=='France'):
            Area=32
            temp1=5
            temp2=17
        elif(Area=='Germany'):
            Area=33
            temp1=1
            temp2=15
        elif(Area=='Ghana'):
            Area=34
            temp1=21
            temp2=33
        elif(Area=='Greece'):
            Area=35
            temp1=12
            temp2=24
        elif(Area=='Guatemala'):
            Area=36
            temp1=14
            temp2=25
        elif(Area=='Guinea'):
            Area=37
            temp1=22
            temp2=32
        elif(Area=='Guyana'):
            Area=38
            temp1=21
            temp2=32
        elif(Area=='Haiti'):
            Area=39
            temp1=21
            temp2=32
        elif(Area=='Honduras'):
            Area=40
            temp1=19
            temp2=30
        elif(Area=='Hungary'):
            Area=41
            temp1=4
            temp2=17
        elif(Area=='India'):
            Area=42
            temp1=18
            temp2=33
        elif(Area=='Indonesia'):
            Area=43
            temp1=20
            temp2=32
        elif(Area=='Iraq'):
            Area=44
            temp1=12
            temp2=30
        elif(Area=='Ireland'):
            Area=45
            temp1=3
            temp2=15
        elif(Area=='Italy'):
            Area=46
            temp1=2
            temp2=18
        elif(Area=='Jamaica'):
            Area=47
            temp1=21
            temp2=32
        elif(Area=='Japan'):
            Area=48
            temp1=7
            temp2=21
        elif(Area=='Kazakhstan'):
            Area=49
            temp1=-1
            temp2=13
        elif(Area=='Kenya'):
            Area=50
            temp1=10
            temp2=22
        elif(Area=='Latvia'):
            Area=51
            temp1=1
            temp2=13
        elif(Area=='Lebanon'):
            Area=53
            temp1=13
            temp2=26
        elif(Area=='Lesotho'):
            Area=54
            temp1=7
            temp2=20
        elif(Area=='Libya'):
            Area=55
            temp1=13
            temp2=26
        elif(Area=='Lithuania'):
            Area=56
            temp1=1
            temp2=12
        elif(Area=='Madagascar'):
            Area=57
            temp1=14
            temp2=25
        elif(Area=='Malawi'):
            Area=58
            temp1=14
            temp2=26
        elif(Area=='Malaysia'):
            Area=59
            temp1=21
            temp2=32
        elif(Area=='Mali'):
            Area=60
            temp1=22
            temp2=33
        elif(Area=='Mauritania'):
            Area=61
            temp1=22
            temp2=33
        elif(Area=='Mauritius'):
            Area=62
            temp1=18
            temp2=29
        elif(Area=='Mexico'):
            Area=63
            temp1=10
            temp2=30
        elif(Area=='Montenegro'):
            Area=64
            temp1=5
            temp2=17
        elif(Area=='Morocco'):
            Area=65
            temp1=11
            temp2=23
        elif(Area=='Mozambique'):
            Area=66
            temp1=16
            temp2=27
        elif(Area=='Namibia'):
            Area=67
            temp1=14
            temp2=26
        elif(Area=='Nepal'):
            Area=68
            temp1=9
            temp2=20
        elif(Area=='Netherlands'):
            Area=69
            temp1=3
            temp2=16
        elif(Area=='New Zealand'):
            Area=70
            temp1=7
            temp2=18
        elif(Area=='Nicaragua'):
            Area=71
            temp1=21
            temp2=32
        elif(Area=='Niger'):
            Area=72
            temp1=23
            temp2=35
        elif(Area=='Norway'):
            Area=73
            temp1=-1
            temp2=8
        elif(Area=='Pakistan'):
            Area=74
            temp1=13
            temp2=33
        elif(Area=='Papua New Guinea'):
            Area=75
            temp1=19
            temp2=31
        elif(Area=='Peru'):
            Area=76
            temp1=11
            temp2=23
        elif(Area=='Poland'):
             Area=76
             temp1=2
             temp2=15
        elif(Area=='Portugal'):
            Area=77
            temp1=10
            temp2=23
        elif(Area=='Qatar'):
            Area=78
            temp1=21
            temp2=34
        elif(Area=='Romania'):
            Area=79
            temp1=5
            temp2=19
        elif(Area=='Rwanda'):
            Area=80
            temp1=14
            temp2=26
        elif(Area=='Saudi Arabia'):
            Area=81
            temp1=19
            temp2=33
        elif(Area=='Senegal'):
            Area=82
            temp1=19
            temp2=32
        elif(Area=='Slovenia'):
            Area=83
            temp1=4
            temp2=17
        elif(Area=='South Africa'):
            Area=84
            temp1=9
            temp2=27
        elif(Area=='Spain'):
            Area=85
            temp1=6
            temp2=23
        elif(Area=='Sri Lanka'):
            Area=86
            temp1=21
            temp2=33
        elif(Area=='Sudan'):
            Area=87
            temp1=21
            temp2=36
        elif(Area=='Suriname'):
            Area=88
            temp1=21
            temp2=33
        elif(Area=='Sweden'):
            Area=89
            temp1=1
            temp2=14
        elif(Area=='Switzerland'):
            Area=90
            temp1=1
            temp2=14
        elif(Area=='Tajikistan'):
            Area=91
            temp1=2
            temp2=16
        elif(Area=='Thailand'):
            Area=92
            temp1=22
            temp2=34
        elif(Area=='Tunisia'):
            Area=93
            temp1=13
            temp2=26
        elif(Area=='Turkey'):
            Area=94
            temp1=5
            temp2=27
        elif(Area=='Uganda'):
            Area=95
            temp1=18
            temp2=30
        elif(Area=='Ukraine'):
            Area=96
            temp1=1
            temp2=16
        elif(Area=='United Kingdom'):
            Area=97
            temp1=2
            temp2=17
        elif(Area=='Uruguay'):
            Area=98
            temp1=11
            temp2=23
        elif(Area=='Zambia'):
            Area=99
            temp1=15
            temp2=27
        elif(Area=='Zimbabwe'):
            Area=100
            temp1=14
            temp2=27
            
       
        Item_x=request.form['myBrowser'] 
        if(Item_x =='Cassava'):
            Item_x =0
        elif(Item_x =='Maize'):
            Item_x=1
        elif(Item_x =='Plantains and others'):
            Item_x=2
        elif(Item_x =='Potatoes'):
            Item_x=3
        elif(Item_x =='Rice, paddy'):
            Item_x=4
        elif(Item_x =='Sorghum'):
            Item_x=5
        elif(Item_x =='Soybeans'):
            Item_x=6
        elif(Item_x =='Sweet potatoes'):
            Item_x=7
        elif(Item_x =='Wheat'):
            Item_x=8
        elif(Item_x =='Yams'):
            Item_x=9
        
        Year = int(request.form['SL'])
        pesticides_tonnes=float(request.form['SW'])
        avg_temp=float(request.form['PL'])
        if(avg_temp<=temp1 or avg_temp>=temp2):
            return render_template('error.html',prediction_texts="This temperature is not applicable for this Area")
        else:
            average_rain_fall_mm_per_year=float(request.form['PW'])
            prediction=model.predict([[ Area,Item_x,Year,average_rain_fall_mm_per_year,pesticides_tonnes, avg_temp]])
            output=round(prediction[0],2)
            return render_template('result.html',prediction_texts="Predicted yield is {} ".format(output))
    else:
       return render_template('result.html') 
   
if __name__ == "__main__":
    app.run(port=8000)
        
